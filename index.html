<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CPEL - Simulado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!--Escondendo o toast do boostrap quando clicar no botão enviar-->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
      $(document).ready(function(){    
          $("#hideBtn").click(function(){
              $("#myToast").toast("hide");
          });
      });
    </script>

  </head>
        <!--
          /* CSS HEX */
        --mustard: #ffde59;
        --black: #060501;
        --amaranth-pink: #fe9dbc;
        --capri: #13aef1;
        --medium-slate-blue: #8c52ff;
        -->
  <body style="background-color: #FFDE59;">

    <nav class="navbar navbar-dark bg-dark navbar-expand-lg">
    <div class="container justify-content-between">
        <a class="navbar-brand">CPEL - Notas do Simulado</a>
        <form class="d-flex was-validated" role="search" id="myForm">
          <div class="input-group">
              <span class="input-group-text" 
              id="inputGroup-sizing-default"
              title="Data de Nascimento"
              >
              <i class="fa-solid fa-cake-candles" style="color: #13AEF1;"></i>
              </span>
              <input class="form-control is-invalid me-2" 
              placeholder="Data de Nascimento" 
              required="" 
              type="date" 
              id="dataNascimento"  
              min="1996-01-01" max="2005-01-31" 
              aria-label="dataNascimento"
              title="Data de Nascimento"
              >
          </div>    
          <button 
          type="submit" 
          class="btn btn-primary" 
          onclick="SendForm()"
          id="hideBtn"
          >
          Acessar
          </button>
        </form>
    </div>
    </nav>

    <div class="toast-container top-2 end-0 p-3">
      <div class="toast fade show text-bg-primary" id="myToast" role="alert" aria-live="assertive" aria-atomic="true" >
        <div class="d-flex">
          <div class="toast-body">
          Olá! Digite aqui sua data de nascimento para ver seus resultado.
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    </div>

    <div class="container m-5">
        <h1 id="mensagemUser">Olá!</h1>
        <p><b>Aqui estão suas notas :)</b></p>
    </div>

    <div class="card p-2 ms-5 me-5 mb-3">
      <div class="card-body">
        <h1 
        class="card-title text-center" 
        style="color:#8C52FF"
        id="notaGeral">
        &#45
        </h1>
        <h6 class="card-subtitle mb-2 text-muted text-center">Quantidade de acertos</h6>
        <div class="progress" id="barNotaGeral">
          <div class="progress-bar" role="progressbar" style="width: 0%; background-color: #8C52FF;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">25%</div>
        </div>
        <!--média d turma-->
        <h5 
        class="card-title text-center mt-1" 
        style="color:#13aef1"
        id="notaMediaGeral">
        &#45 
        </h5>
        <h6 class="card-subtitle mb-2 text-muted text-center">Média da turma</h6>
        <div class="progress" id="barMediaGeral">
          <div class="progress-bar" role="progressbar" style="width: 0%; background-color: #13aef1;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">58%</div>
        </div>
      </div>
    </div>

    <div class="card p-2 ms-5 me-5 mb-3">
      <div class="card-body text-center">
        <h4 class="card-title">6</h4>
        <h6 class="card-subtitle mb-2 text-muted">Português</h6>
      </div>
    </div>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

    <script>


    function Notas(){
        const dados = new Request('./data/data.json');
        fetch(dados)
        .then(response => response.json())
        .then(data =>{
        var acertosGerais = data[0][`${dataJoin}`]["geral"]
        console.log("Acertos gerais", acertosGerais)
        var acertos = acertosGerais

        var notaGeral = document.getElementById("notaGeral");
        notaGeral.innerHTML = `${acertos}`

        var porcentagemNota = ((100/60)*acertos).toFixed(2)
        console.log("porcentagem notas", porcentagemNota)

        var barNotaGeral = document.getElementById("barNotaGeral");
        barNotaGeral.innerHTML = `<div class="progress-bar" role="progressbar" style="width: ${porcentagemNota}%; background-color: #8C52FF;" aria-valuenow="${porcentagemNota}" aria-valuemin="0" aria-valuemax="100">${porcentagemNota}%</div>`
        })

        };

    function Medias(){
          const dados = new Request('./data/data.json');
          fetch(dados)
          .then(response => response.json())
          .then(data =>{
          var mediaGeral = data[0]["media"]["geral"]
          console.log("media geral", mediaGeral)

          var notaMedia = document.getElementById("notaMediaGeral");
          notaMedia.innerHTML = `${mediaGeral}`

          var barMediaGeral = document.getElementById("barMediaGeral");
          barMediaGeral.innerHTML = `<div class="progress-bar" role="progressbar" style="width: ${mediaGeral}%; background-color: #8C52FF;" aria-valuenow="${mediaGeral}" aria-valuemin="0" aria-valuemax="100">${mediaGeral}%</div>`
        })
    }

    function SendForm(){
      
        var data = document.getElementById("dataNascimento").value;
        var dataInvertida = data.split('-').reverse().join('/')
        dataJoin = data.split('-').reverse().join('')

        console.log("Data Nascimento", data)
        console.log("Data Invertida", dataInvertida)
        console.log("Data Join", dataJoin)

        var mensagemUser = document.getElementById("mensagemUser");
        mensagemUser.innerHTML = `Olá, ${dataInvertida}!`

        //teste pegar notas para barra
        //getDatas()
        //var acertos = acertosGerais

        const dados = new Request('./data/data.json');
        fetch(dados)
        .then(response => response.json())
        .then(data => {
        try {
          testeErro = data[0][`${dataJoin}`]["Acertos"]
        } catch (error) {
          if ( error.fileName == undefined) {
            console.log("Não encontrado")
            mensagemUser.innerHTML = `Não encontramos: ${dataInvertida}!`
            return
          }else{
            return
          }
        }

        Notas()
        Medias()
        console.log("depois...")


        });       

        

      }

        var form = document.getElementById("myForm");
        function handleForm(event) { event.preventDefault(); } 
        form.addEventListener('submit', handleForm);

    function getDatas(){  

        // var data = document.getElementById("dataNascimento").value;
        // var dataJoin = data.split('-').reverse().join('')
        // var gabarito = "gabarito"

        const dados = new Request('./data/data.json');
        fetch(dados)
        .then(response => response.json())
        .then(data => {
            
            var acertosGerais = data[0][`${dataJoin}`]["Acertos"]
            console.log("Acertos gerais", acertosGerais)

            var acertos = acertosGerais
            
            // //número da questão
            // let q1 = document.getElementsByTagName("span")[0].id;
            
            // console.log("questao", q1)

            // function isKeyExists(obj,key){
            //     return obj.hasOwnProperty(key);
            // }

            // console.log("TEM ESSE VALOR? "+isKeyExists(`${data[0]}`, "12"))
            
            // //letra marcada pelo aluno
            // document.getElementById(`${q1}`).innerHTML = `${data[0][`${codAluno}`][`${q1}`]}`;
                   
            // //cores
            // if (`${data[0][`${codAluno}`][`${q1}`]}` == `${data[1][`${gabarito}`][`${q1}`]}`) {
            //     document.getElementById(`${q1}`).classList.add('bg-primary');
            // } else {
            //     document.getElementById(`${q1}`).classList.add('bg-danger');
            // };

        });
    }
    </script>
  </body>
</html>